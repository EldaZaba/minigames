<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pexeso (Memory) - Mƒõ to nebav√≠ CZ</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="../assets/theme.css" />
  <script src="../assets/theme.js" defer></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: clamp(16px, 3vw, 32px);
      gap: 1rem;
    }
    header {
      text-align: center;
    }
    #gameBoard {
      --card-size: clamp(70px, 18vw, 96px);
      display: grid;
      grid-template-columns: repeat(4, var(--card-size));
      gap: 12px;
      justify-content: center;
    }
    .card {
      width: var(--card-size);
      height: var(--card-size);
      border-radius: 16px;
      border: 1px solid var(--surface-border);
      box-shadow: var(--shadow-soft);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: clamp(30px, 6vw, 46px);
      cursor: pointer;
      user-select: none;
      position: relative;
      perspective: 600px;
      background: var(--surface);
    }
    .card.flipped .front {
      transform: rotateY(0deg);
      color: #ffffff;
    }
    .card.flipped .back {
      transform: rotateY(180deg);
    }
    .card .front,
    .card .back {
      position: absolute;
      inset: 0;
      border-radius: 16px;
      backface-visibility: hidden;
      transition: transform 0.35s;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: 700;
    }
    .card .front {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: transparent;
      transform: rotateY(180deg);
    }
    .card .back {
      background: var(--surface-2);
      color: var(--text);
      font-size: clamp(28px, 5.6vw, 42px);
    }
    .score-pill.active {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #ffffff;
      border-color: transparent;
    }
    @media (max-width: 520px) {
      #gameBoard {
        gap: 10px;
      }
    }
  </style>
</head>
<body class="game-page">
  <header>
    <h1 class="hero-title">Pexeso</h1>
    <p class="hero-subtitle">Najdƒõte v≈°echny dvojice karet co nejrychleji.</p>
  </header>

  <div class="panel game-shell" role="main" aria-label="Pexeso">
    <div id="gameBoard" aria-label="Hern√≠ plocha pexesa" role="grid"></div>
    <div id="playerInfo" class="hud" aria-live="polite">
      <span id="player1" class="score-pill active">Hr√°ƒç 1: 0 bod≈Ø</span>
      <span id="player2" class="score-pill">Hr√°ƒç 2: 0 bod≈Ø</span>
    </div>
    <div class="controls">
      <button id="btnRestart" class="btn btn-secondary">Restart</button>
    </div>
  </div>
  <a href="../games.html" class="link-back">Zpƒõt na v√Ωbƒõr her</a>

  <script>
    const symbols = ['üçé', 'üçå', 'üçá', 'üçâ', 'üçí', 'ü•ù', 'üçç', 'üçì'];
    let cards = [];
    let flippedCards = [];
    let matchedCount = 0;
    let currentPlayer = 1;
    let scores = {1: 0, 2: 0};
    const gameBoard = document.getElementById('gameBoard');
    const player1Display = document.getElementById('player1');
    const player2Display = document.getElementById('player2');
    const btnRestart = document.getElementById('btnRestart');

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function createCards() {
      cards = [];
      symbols.forEach(symbol => {
        cards.push({symbol, id: Math.random()});
        cards.push({symbol, id: Math.random()});
      });
      cards = shuffle(cards);
    }

    function renderCards() {
      gameBoard.innerHTML = '';
      cards.forEach((card, index) => {
        const cardElement = document.createElement('div');
        cardElement.classList.add('card');
        cardElement.setAttribute('role', 'button');
        cardElement.setAttribute('tabindex', '0');
        cardElement.setAttribute('aria-label', 'Karta');
        cardElement.dataset.index = index;

        const front = document.createElement('div');
        front.classList.add('front');
        front.textContent = card.symbol;

        const back = document.createElement('div');
        back.classList.add('back');
        back.textContent = '‚ùì';

        cardElement.appendChild(front);
        cardElement.appendChild(back);

        cardElement.addEventListener('click', () => flipCard(cardElement));
        cardElement.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            flipCard(cardElement);
          }
        });

        gameBoard.appendChild(cardElement);
      });
    }

    function updatePlayerInfo() {
      player1Display.textContent = `Hr√°ƒç 1: ${scores[1]} bod≈Ø`;
      player2Display.textContent = `Hr√°ƒç 2: ${scores[2]} bod≈Ø`;
      if (currentPlayer === 1) {
        player1Display.classList.add('active');
        player2Display.classList.remove('active');
      } else {
        player2Display.classList.add('active');
        player1Display.classList.remove('active');
      }
    }

    function flipCard(cardElement) {
      if (flippedCards.length === 2 || cardElement.classList.contains('flipped')) return;

      cardElement.classList.add('flipped');
      flippedCards.push(cardElement);

      if (flippedCards.length === 2) {
        setTimeout(checkMatch, 1000);
      }
    }

    function checkMatch() {
      const [card1, card2] = flippedCards;
      const index1 = card1.dataset.index;
      const index2 = card2.dataset.index;

      if (cards[index1].symbol === cards[index2].symbol) {
        matchedCount += 2;
        scores[currentPlayer]++;
        updatePlayerInfo();
        flippedCards = [];
        if (matchedCount === cards.length) {
          let winner;
          if (scores[1] > scores[2]) winner = 'Hr√°ƒç 1';
          else if (scores[2] > scores[1]) winner = 'Hr√°ƒç 2';
          else winner = 'Rem√≠za';
          setTimeout(() => alert(`Konec hry! V√Ωsledek: ${winner}`), 200);
        }
      } else {
        flippedCards.forEach(card => card.classList.remove('flipped'));
        flippedCards = [];
        currentPlayer = currentPlayer === 1 ? 2 : 1;
        updatePlayerInfo();
      }
    }

    function restartGame() {
      matchedCount = 0;
      scores = {1: 0, 2: 0};
      currentPlayer = 1;
      flippedCards = [];
      createCards();
      renderCards();
      updatePlayerInfo();
    }

    btnRestart.addEventListener('click', restartGame);

    restartGame();
  </script>
</body>
</html>
